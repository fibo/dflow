#!/usr/bin/env node

process.title = 'dflow'

var nopt = require('nopt')

var pkg = require('../../package.json')
var usage = require('./usage')
var actions = require('./actions')

const edit = actions.edit
const run = actions.run
const validate = actions.validate

var knownOpts = {
  help: Boolean,
  version: Boolean
}

var shortHandOpts = {
  h: '--help'
}

var args = process.argv

var opt = nopt(knownOpts, shortHandOpts, args, 2)

if (opt.version) {
  console.log(pkg.version)
  process.exit(0)
}

var remain = opt.argv.remain

if (remain.length === 0) {
  // Show help.
  if (opt.help) {
    console.log(usage)
    process.exit(0)
  }

  // Default action is *edit*
  edit(args)
}

if (remain[0] === 'edit') edit(args)

if (remain[0] === 'run') run(args)

if (remain[0] === 'validate') validate(args)
